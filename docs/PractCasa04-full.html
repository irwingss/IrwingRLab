<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Gráficos Avanzados con ggplot2</title>

<script src="site_libs/header-attrs-2.7/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R Lationamérica - RLab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Inicio</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Prácticas
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="PractCasa01-full.html">Práctica de Casa 1: Programación Básica con R</a>
    </li>
    <li>
      <a href="PractCasa02-full.html">Práctica de Casa 2: Programación con R y dplyr</a>
    </li>
    <li>
      <a href="PractCasa03-full.html">Práctica de Casa 3: Análisis Estadístico Básico</a>
    </li>
    <li>
      <a href="PractCasa04-full.html">Práctica de Casa 4: Gráficos Avanzados con ggplot2</a>
    </li>
    <li>
      <a href="PractCasa05-full.html">Práctica de Casa 5: Modelos Lineales de Efectos Mixtos (LMM)</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Gráficos Avanzados con ggplot2</h1>

</div>


<div id="práctica-de-casa-04---gráficos-avanzados-con-ggplot2" class="section level1">
<h1><strong>Práctica de Casa 04 - Gráficos Avanzados con ggplot2</strong></h1>
<p>Link de la práctica desarrollada: <a href="https://irwingss.github.io/IrwingRLab/PractCasa04-full.html">Práctica de Casa 04 - Gráficos Avanzados con ggplot2 (irwingss.github.io)</a></p>
<p>Realiza los siguientes ejercicios durante tu tiempo libre para reforzar practicar las funciones adicionales y geoms que aprendiste durante la semana 7 y 8 del programa (Curso 3).</p>
<p>Recuerda realizar esta práctica luego de haber desarrollado:</p>
<ul>
<li><p>R-Notebook-C3-S1 parte 1.Rmd</p></li>
<li><p>R-Notebook-C3-S1 parte 2.Rmd</p></li>
<li><p>R-Notebook-C3-S2.Rmd</p></li>
</ul>
<blockquote>
<p><strong>Nota 1:</strong> Si necesitas crear un code chunk los atajos en el teclado son en WINDOWS: <code>Crtl+Alt+i</code>, y en MAC: <code>Command+Alt+i</code>.</p>
</blockquote>
<p><strong>Activa las librarías a usar</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggThemeAssist)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span></code></pre></div>
</div>
<div id="ejercicio-1" class="section level1">
<h1><strong>Ejercicio 1:</strong></h1>
<p>Carga la base de datos <code>mtcars</code> para realizar el siguiente gráfico (<a href="https://drive.google.com/file/d/1quxRn_JU69D79R9QfmO1G8Yr3M0XwuHk/view?usp=sharing">click aquí para verlo</a>). Puedes intentar hacerlo todo desde cero por ti mismo como un reto personal (no obstante, revisa el punto 6, 7y 8 porque es información nueva y específica), pero si aún no te sientes muy familiarizado con ggplot2, solo sigue las instrucciones brindadas a continuación:</p>
<ol style="list-style-type: decimal">
<li><p>Crea un gráfico de dispersión de puntos entre las millas por galón (columna <code>mpg</code>) y el peso (columna <code>wt</code>) de la base de datos mtcars.</p></li>
<li><p>Colorea por la cantidad de carburadores que presenta el auto (columna <code>carb</code>). La base de datos lee todas las columnas como valores continuos. Asegúrate de convertir a factor la columna de trabajo para que genere el gráfico con colores discretos.</p></li>
<li><p>Define la forma de los puntos en base al tipo de motor (columna <code>vs</code>)</p></li>
<li><p>Adiciona las etiquetas de</p>
<ul>
<li><p>Título:“Rendimiento de los Motores Lineares y Tipo V”</p></li>
<li><p>Subtítulo: “Los datos se extrajeron de la revista Motor Trend (USA, 1974)”</p></li>
<li><p>Eje x: “Millas/Galón”</p></li>
<li><p>Eje y: “Peso (1000 libras)”</p></li>
<li><p>Leyenda para el color: “Número de Carburadores”</p></li>
</ul></li>
<li><p>Usa la paleta de colores <code>"Dark2"</code> para colorear los puntos</p></li>
<li><p>Usa la faceta <code>facet_wrap()</code> para dividir el gráfico en base al tipo de motor (columna <code>vs</code>). Debes asegurarte que la columna sea un factor para que pueda graficar. Además, debes reemplazar el valor <code>0</code> por el nombre <code>"Tipo V"</code> y el valor <code>1</code> por <code>"Linear"</code>. Dentro de la función de faceta puedes definir el número de filas en las que dividirá el gráfico, coloca el argumento <code>nrow=2</code> para que genere las facetas en dos filas.</p></li>
<li><p>Usemos <code>theme()</code> para indicar la ubicación de la leyenda en la parte inferior del gráfico. El argumento que hace esto es <code>legend.position = "bottom"</code>. Las posiciones que admite son <code>"top"</code> arriba, <code>"bottom"</code> abajo, <code>"left"</code> izquierda, <code>"rigth"</code> derecha.</p></li>
<li><p>Usa una nueva función adicional llamada <code>guides()</code> que permite modificar algunas cosas la leyenda. En este punto, tu gráfico debe tener dos leyendas. Si deseamos eliminar alguna leyenda que no nos es útil (como la de la forma de los puntos, dado que ya aplicamos facetas separándolos), escribimos el tipo de origen de la leyenda (el argumento de <code>aes()</code> que la genera) y le indicamos <code>FALSE</code> para que desaparezca así: <code>guides(shape=FALSE)</code>.</p></li>
<li><p>El objetivo es poner la leyenda en la parte inferior de la gráfica, y en una sola fila. Esto lograremos indicando dentro de <code>guides()</code> el argumento de <code>aes()</code> que la genera el color (que define al número de carburadores) tenga el valor <code>guide_legend(nrow = 1)</code>, así <code>: color=guide_legend(nrow = 1)</code>. Significa que forzamos a que la leyenda de color ponga sus valores en una sola línea.</p></li>
<li><p>Selecciona el código del gráfico por completo, y abre <code>Addins/ggplot Theme Assistant</code> para que veas el asistente de graficación y termines con ello de modificar el gráfico:</p>
<ul>
<li><p>Colorea las líneas mayores del panel con el color <code>gray95</code>.</p></li>
<li><p>Elimina las líneas menores del panel colocandole el tipo <code>blank</code> para que no se muestren.</p></li>
<li><p>Coloca el rellenado de fondo (Background) del plot como <code>gray90</code>.</p></li>
<li><p>Coloca el rellenado del panel como <code>gray90</code>.</p></li>
<li><p>Coloca el color del borde del panel como <code>gray70</code>.</p></li>
<li><p>Coloca el título del Plot en negrita <code>bold</code> y tamaño de letra <code>13</code>.</p></li>
<li><p>Coloca el subtítulo del Plot en tamaño de letra <code>10</code>.</p></li>
<li><p>Coloca el título de los ejes (axis) en negrita <code>bold</code> y tamaño de letra <code>10</code>.</p></li>
<li><p>Coloca el título de la leyenda en negrita <code>bold</code>.</p></li>
<li><p>Coloca el color del fondo (background) de la leyenda en <code>None</code> para que desaparezca el color.</p></li>
<li><p>Coloca el color del fondo de las claves (key) de la leyenda en <code>None</code> para que desaparezca el color.</p></li>
</ul></li>
<li><p><strong>Adicional:</strong> si deseas aumentar el margen del plot cuando lo exportes y que tenga más espacio a los costados, arriba y abajo, usa el argumento dentro de <code>theme()</code> que modifica los márgenes: <code>plot.margin = unit(c(1,1,1,1),"cm")</code>. Esto deberás hacerlo manualmente. Así obtendrás exactamente la misma figura que la presentada aquí en el ejercicio.</p></li>
</ol>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;mtcars&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>mpg, <span class="at">y=</span>wt, <span class="at">color=</span><span class="fu">factor</span>(carb),<span class="at">shape=</span><span class="fu">factor</span>(vs)))<span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Millas/Galón&quot;</span>, <span class="at">y=</span><span class="st">&quot;Peso (1000 libras)&quot;</span>, <span class="at">color=</span><span class="st">&quot;Número de Carburadores&quot;</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">&quot;Rendimiento de los Motores Lineares y Tipo V&quot;</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">&quot;Los datos se extrajeron de la revista Motor Trend (USA, 1974)&quot;</span>)<span class="sc">+</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>)<span class="sc">+</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">factor</span>(vs, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;1&quot;</span><span class="ot">=</span><span class="st">&quot;Linear&quot;</span>, <span class="st">&quot;0&quot;</span><span class="ot">=</span><span class="st">&quot;Tipo V&quot;</span>)), <span class="at">nrow =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)<span class="sc">+</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape=</span><span class="cn">FALSE</span>, <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;gray95&quot;</span>),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">&quot;blank&quot;</span>), </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;gray90&quot;</span>), </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;gray90&quot;</span>, </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">colour =</span> <span class="st">&quot;gray70&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>), </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),  </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>), </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>), </span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>))</span></code></pre></div>
<p><img src="PractCasa04-full_files/figure-html/unnamed-chunk-2-1.png" /><!-- --></p>
</div>
<div id="ejercicio-2" class="section level1">
<h1><strong>Ejercicio 2:</strong></h1>
<p>En este ejercicio aprenderás que la posición de <code>theme_XYZ()</code> y <code>theme()</code> importa. Si colocamos primero <code>theme()</code> y luego <code>theme_XYZ()</code>, no importa cuántas modificaciones se hayan realizado con <code>theme()</code>, todo será reemplazado con las modificaciones predefinidas del <code>theme_XYZ()</code> que escogiste. No obstante, al hacerlo al revés, primero <code>theme_XYZ()</code> y luego <code>theme()</code>, primero modificamos todo con un tema predefinido, y luego realizamos modificaciones con <code>theme()</code> sobre el <code>theme_XYZ()</code> para dejar lo que nos guste pero modificar aquello que no deseamos. Recuerda que <code>theme_XYZ()</code> es un ejemplo que puede ser reemplazado con cualquier tema predefinido de <code>ggplot</code> o <code>ggthemes</code>.</p>
<p>Carga la base de datos <code>gapminder</code> para realizar el siguiente gráfico (<a href="https://drive.google.com/file/d/19hocB0GlowNKcQPdgwyZv1kcbqyb4Iw9/view?usp=sharing">click aquí para verlo</a>). Puedes intentar hacerlo todo desde cero por ti mismo como un reto personal, pero si aún no te sientes muy familiarizado con ggplot2, solo sigue las instrucciones brindadas a continuación. Sin embargo las instrucciones demandan que recuerdes el uso de ciertas funciones de <code>ggplot2</code>:</p>
<ol style="list-style-type: decimal">
<li>Filtra la base de datos para quedarte solo con los datos de los países Perú, Colombia, Chile y Ecuador.</li>
<li>Utiliza como eje x el año (<code>year</code>), y como eje y el tamaño poblacional (<code>pop</code>) didivido entre 1 millón para expresar ese eje en millones. Colorea por el país (<code>country</code>).</li>
<li>Genera una geométrica de líneas.</li>
<li>Genera una línea roja vertical con intercepto en 1990 porque deseas mostrar esa fecha como punto de referencia entre los países. Selecciona el tipo de línea con guiones.</li>
<li>Define breaks de cada eje según la figura del link.</li>
<li>Usa la paleta <code>"Set2"</code> con una función que te permita colocar paletas (colores discretos)</li>
<li>Cambia el título de los ejes x e y por los respectivos en la figura.</li>
<li>Define el título y subtítulo.</li>
<li>Usa el tema <code>theme_solarized()</code>. Del cual mantendremos casi todo. Las modificaciones que haremos se realizarán seguido dentro de <code>theme()</code>.</li>
<li>Usando <code>ggThemeAssist</code> elimina el color de fondo de la leyenda, o cólocalo como blanco. Cambia la <code>face</code> del título de <code>plain</code> (texto plano) a <code>bold</code> (negritas).</li>
<li>Intenta cambiar el orden de <code>theme()</code> y <code>theme_solarized()</code> para que veas la influencia del orden.</li>
<li>Regresa el gráfico al orden <code>theme_solarized()</code> y luego <code>theme()</code>.</li>
<li>Cambiemos el color de las letras. Esto no se hace rápidamente con <code>ggThemeAssist</code>. Escribe los argumentos dentro de <code>theme()</code>: para modificar todo el texto del gráfico (de la leyenda y de los ejes) <code>text =</code>, y para modificar todos los títulos (del plot y de los ejes) <code>title =</code>. Como ambos son elementos de texto, debes escribir: <code>text=element_text(), title=element_text()</code>.</li>
<li>Dentro de cada elemento de texto simplemente cambia el color a negro con <code>color="black"</code>. Resultado: <code>text = element_text(color="black"), title = element_text(color="black")</code>.</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(gapminder)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> <span class="fu">filter</span>(country<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Peru&quot;</span>,<span class="st">&quot;Colombia&quot;</span>,<span class="st">&quot;Chile&quot;</span>,<span class="st">&quot;Ecuador&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>year, <span class="at">y=</span>(pop<span class="sc">/</span><span class="dv">1000000</span>), <span class="at">color=</span>country))<span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">1990</span>,<span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="fl">0.6</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1950</span>,<span class="dv">2010</span>,<span class="dv">5</span>), <span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>)<span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Peru&quot;</span><span class="ot">=</span><span class="st">&quot;Perú&quot;</span>))<span class="sc">+</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Año&quot;</span>,<span class="at">y=</span><span class="st">&quot;Población en Millones&quot;</span>, <span class="at">color=</span><span class="st">&quot;País&quot;</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Tendencia Poblacional&quot;</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Datos tomados de los cuatro Países Sudamericanos con mayor PBI&quot;</span>)<span class="sc">+</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_solarized</span>()<span class="sc">+</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>),</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="dv">2</span>),</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>))</span></code></pre></div>
<pre><code>## Scale for &#39;colour&#39; is already present. Adding another scale for &#39;colour&#39;,
## which will replace the existing scale.</code></pre>
<p><img src="PractCasa04-full_files/figure-html/unnamed-chunk-3-1.png" /><!-- --></p>
</div>
<div id="ejercicio-3" class="section level1">
<h1>Ejercicio 3:</h1>
<p>Carga la base de datos <code>dat</code> usando el siguiente código para obtenerla desde Drive Google y realizar el siguiente gráfico (<a href="https://drive.google.com/file/d/1jdl744Tt9WLMy16xEQ8jHAjY84q9GYit/view?usp=sharing">click aquí para verlo</a>).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> <span class="st">&quot;1Ir5XteDKcStjsUlnMXuYKI6s2Qscmgy-&quot;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">sprintf</span>(<span class="st">&quot;https://docs.google.com/uc?id=%s&amp;export=download&quot;</span>, id))</span></code></pre></div>
<p>Puedes intentar hacerlo todo desde cero por ti mismo como un reto personal, pero si aún no te sientes muy familiarizado con ggplot2, solo sigue las instrucciones brindadas a continuación. Sin embargo las instrucciones demandan que recuerdes el uso de ciertas funciones de <code>ggplot2</code>:</p>
<ol style="list-style-type: decimal">
<li><p>Dado que en ggplot solo puedes colocar una columna en el eje x, una en el eje y, y una como relleno, la tabla actual no nos es útil. Debemos convertirla en tabla larga con la función <code>gather()</code> de la librería <code>dplyr</code>. Apila las columnas 3 a la 7.</p></li>
<li><p>Seguido, usa mutate para convertir los valores <code>0</code> a <code>NA</code> con la función <code>ifelse()</code>. Esto es necesario porque un argumento dentro de las funciones de coloreo/rellenado permite colocar un color a los valores <code>NA</code>. Por ejemplo: <code>na.value = "grey90"</code>, hará que los <code>NA</code> sean celdas grises muy claro en el gráfico. Esto lo usaremos más adelante.</p></li>
<li><p>Crea el <code>ggplot()</code> definiendo como aestéticas <code>x= forcats::fct_rev(categoria)</code>. Esto implica usar la función <code>fct_rev()</code> de la librería <code>forcats</code>. Para entender mejor: <code>fct_rev()</code> significa factor reverse para invertir el orden de un factor. La siguiente aestética debe ser el eje y conteniendo las etiquetas apiladas por <code>gather()</code> con el nombre <code>key</code>. Por último usa <code>value2</code> para rellenar, pero convirtiéndolo en un factor para generar rellenado discreto.</p></li>
<li><p>Coloca la geométrica respectiva para hacer tiles, indicando color <code>"white"</code> para que tenga bordes blancos y <code>size = 0.2</code> para hacer las líneas de borde más sutiles.</p></li>
<li><p>Gira el gráfico para que el eje y tenga los valores de la columna <code>categoria</code>.</p></li>
<li><p>Coloca los títulos del gráfico y ejes como corresponda.</p></li>
<li><p>Usa la función de rellenado de <code>ggthemes</code> para rellenar con la paleta <code>"Tableau 20"</code>. Adiciona el argumento <code>na.value = "grey90"</code> para que los <code>NA</code> se rellenen con gris claro, y el argumento: <code>breaks=c(1:10,14,16)</code> para que las leyendas de rellenado contengan todos los valores de conteo de cada tile pero sin menciona al <code>NA</code>.</p></li>
<li><p>Usa <code>ggThemeAssist</code> para definir:</p>
<ul>
<li><p>El título del plot en negrita tamaño 13.</p></li>
<li><p>Los grid mayores y menores del panel gráfico como <code>None</code> o <code>element_blank()</code> para que desaparezcan.</p></li>
<li><p>Poner el título de la leyenda en negritas.</p></li>
<li><p>Tamaño del texto del eje x en 9, y del eje y en 3.</p></li>
<li><p>Color del panel como <code>None</code> para que desaparezca el borde del panel.</p></li>
<li><p><strong>Adicionalmente</strong>, puedes ponerle margenes al gráfico como vimos en el ejercicio anterior con el argumento <code>plot.margin=unit(c(1,1,1,1),"cm")</code>.</p></li>
</ul></li>
<li><p>Finalmente, puedes separar las observaciones adicionando una faceta para crear un gráfico para cada nivel de la columna <code>factor1</code>.</p></li>
</ol>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key=</span>key, <span class="at">value=</span>value, <span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value2 =</span> <span class="fu">ifelse</span>(value<span class="sc">==</span><span class="dv">0</span>,<span class="cn">NA</span>,value)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>(categoria), <span class="at">y=</span>key, <span class="at">fill=</span><span class="fu">factor</span>(value2)))<span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>,<span class="at">size=</span><span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>,<span class="at">y=</span><span class="st">&quot;&quot;</span>,<span class="at">title=</span><span class="st">&quot;Abundancia de Observaciones&quot;</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill=</span><span class="st">&quot;Conteo&quot;</span>)<span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">scale_fill_tableau</span>(<span class="at">palette =</span> <span class="st">&quot;Tableau 20&quot;</span>, <span class="at">na.value =</span> <span class="st">&quot;grey90&quot;</span>,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">14</span>,<span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>, <span class="at">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">9</span>),</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="dv">3</span>),</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border=</span><span class="fu">element_blank</span>(),</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="st">&quot;cm&quot;</span>))<span class="sc">+</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>factor1)</span></code></pre></div>
<p><img src="PractCasa04-full_files/figure-html/unnamed-chunk-5-1.png" /><!-- --></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
